macro(install_symlink from to)
   install(CODE 
      "execute_process(COMMAND mkdir -p ${SDK_INSTALL_PREFIX}/bin)
       execute_process(COMMAND mkdir -p ${CMAKE_INSTALL_PREFIX}/bin)
       execute_process(COMMAND ln -sf ${SDK_INSTALL_PREFIX}/bin/${from} ${CMAKE_INSTALL_PREFIX}/bin/${to})")
endmacro()

install_symlink(llvm-ranlib eosio.ranlib)

# install clang and llvm
set(CLANG_BIN_DIR ${CMAKE_BINARY_DIR}/EosioClang-prefix/src/EosioClang-build/bin)
install(FILES ${CLANG_BIN_DIR}/llvm-ranlib 
   DESTINATION ${SDK_INSTALL_PREFIX}/bin
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/llvm-ar 
   DESTINATION ${SDK_INSTALL_PREFIX}/bin 
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/llvm-nm 
   DESTINATION ${SDK_INSTALL_PREFIX}/bin 
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/llvm-objcopy
   DESTINATION ${SDK_INSTALL_PREFIX}/bin 
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/llvm-readobj
   DESTINATION ${SDK_INSTALL_PREFIX}/bin 
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/llvm-objdump 
   DESTINATION ${SDK_INSTALL_PREFIX}/bin 
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/llvm-readelf 
   DESTINATION ${SDK_INSTALL_PREFIX}/bin 
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/opt
   DESTINATION ${SDK_INSTALL_PREFIX}/bin
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/llc
   DESTINATION ${SDK_INSTALL_PREFIX}/bin
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/lld
   DESTINATION ${SDK_INSTALL_PREFIX}/bin
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/llvm-strip
   DESTINATION ${SDK_INSTALL_PREFIX}/bin
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/clang-7 
   DESTINATION ${SDK_INSTALL_PREFIX}/bin
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/wasm-ld
   DESTINATION ${SDK_INSTALL_PREFIX}/bin
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/eosio.cc
   DESTINATION ${SDK_INSTALL_PREFIX}/bin
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/eosio.cpp 
   DESTINATION ${SDK_INSTALL_PREFIX}/bin 
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/eosio.ld 
   DESTINATION ${SDK_INSTALL_PREFIX}/bin 
   PERMISSIONS OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
install(FILES ${CLANG_BIN_DIR}/../lib/LLVMEosioApply${CMAKE_SHARED_LIBRARY_SUFFIX}
   DESTINATION ${SDK_INSTALL_PREFIX}/bin)

install_symlink(llvm-ranlib eosio.ranlib)
install_symlink(llvm-ar eosio.ar)
install_symlink(llvm-objdump eosio.objdump)
install_symlink(llvm-readelf eosio.readelf)
install_symlink(eosio.cc eosio.cc)
install_symlink(eosio.cpp eosio.cpp)
install_symlink(eosio.ld eosio.ld)

install(CODE "execute_process(COMMAND ln -sf 
   ${CLANG_BIN_DIR}/clang-7
   ${SDK_INSTALL_PREFIX}/bin/clang)")
install(CODE "execute_process(COMMAND ln -sf 
   ${CLANG_BIN_DIR}/clang-7
   ${SDK_INSTALL_PREFIX}/bin/clang++)")
